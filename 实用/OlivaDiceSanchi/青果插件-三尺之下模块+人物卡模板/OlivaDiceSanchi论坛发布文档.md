# 三尺之下模块（三尺之下跑团专用插件+人物卡模板）

- **名称**​：三尺之下模块
- ​**作者**​：Desom-fu
- ​**版本**​：1.0.0
- ​**兼容版本**​：理论兼容所有版本，但仅在最新版本测试过
- ​**平台**​：理论支持全平台（仅在 QQ 部署测试过）
- ​**操作系统**​：理论支持全系统（仅在 Windows Server 2019 上部署过）
- **前置插件**：OlivaDiceCore
- ​**三尺之下跑团官方群**：1035721236

---

## 注意事项

- 建议使用最新构建版`OlivaDiceCore`以获得最佳体验
- 下载地址：https://github.com/OlivOS-Team/OlivaDiceCore/actions
- （记得解压！）
[upl-file uuid=71a33eee-928e-4e55-a52e-ca1118628e4d size=197kB]olivadicecore.zip[/upl-file]

- 建议使用最新构建版`OlivaDiceNativeGUI`以获得最佳体验
- 下载地址：https://github.com/Desom-fu/OlivaDiceNativeGUI/actions
- （记得解压！）
[upl-file uuid=7e860b49-2b94-427f-adc0-576df28df16f size=237kB]olivadicenativegui.zip[/upl-file]

- （可选）建议使用最新构建版`OlivaDiceMaster`以获得最佳体验
- 下载地址：https://github.com/Desom-fu/OlivaDiceMaster/actions
- （记得解压！）
[upl-file uuid=fe737573-ed31-499f-8830-9aeaed227877 size=31kB]olivadicemaster.zip[/upl-file]

- 下载完毕后建议打开`OlivaDice 设置面板`的自定义回复，在回复词中的`配置恢复模块`里面新增一行`OlivaDiceSanchi`（注意大小写要完全一致!）

---

## 下载

- ###### ​**插件包（记得解压！）** ​:
[upl-file uuid=2be99a21-b003-4882-93ee-49fb4b9c1f4f size=24kB]olivadicesanchi.zip[/upl-file]

- ###### **三尺之下青果专用人物卡模板（解压！）** :
[upl-file uuid=91a6b953-45aa-4aec-9c20-f350092f860f size=24kB]olivadicesanchi.zip[/upl-file]

---

## 更新日志

## 2025.9.20 v1.0.0发布：
- 三尺之下插件发布
- 支持完整的三尺之下铜钱卦系统
- 支持优势/劣势转换机制和铜钱调整
- 支持六爻摇卦功能，自动生成角色属性
- 包含64卦完整数据库和五行属性系统
- 支持三尺之下检定和对抗系统
- 自动寿数计算和属性波动检定

---

## 核心功能

### 铜钱占卜系统
- 新增 `.tq` 命令，用来进行三尺之下铜钱占卜
- 支持优势/劣势转换（b/p参数）
- 支持铜钱数量调整（u/d参数）
- 支持多次投掷和表达式解析
- 自动统计阴爻阳爻数量

### 检定系统
- 新增 `.tqa` 命令，用来进行三尺之下技能检定
- 根据属性和难度差值自动判定成功条件
- 支持简单/标准/困难/极难四种检定等级
- 根据难度数值显示普通/困难/极难成功
- 支持代投和暗骰功能

### 对抗系统
- 新增 `.tqav` 命令，用来进行三尺之下对抗检定
- 双方各投3枚铜钱，阳爻数+属性值对比
- 支持双方独立的优势/劣势设置
- 详细显示对抗过程和最终结果

### 命数摇卦系统
- 新增 `.摇卦` 命令，用来进行六爻摇卦
- 投掷六枚铜钱生成64卦之一
- 自动计算五行属性（金、木、水、火、土）
- 自动处理属性波动（"2-3"格式）
- 根据五行总和计算寿数（乾坤固定，其他卦动态）
- 显示完整卦象信息、角色特质、特殊能力

---

## 使用方法

1. 下载插件包并且解压后，将插件放到 `YourOlivOSPath\plugin\app` 这个路径里
2. 下载人物卡模板并且解压后，将人物卡模板放到 `YourOlivOSPath\plugin\data\OlivaDice\unity\extend\template` 这个路径里
3. 重载插件
4. 可在GUI里面自定义回复

---

## 命令详解

### .tq - 铜钱占卜
```
.tq(h)(b/p/u/d数字)(次数)#(铜钱数量或表达式)

参数说明：
- h：暗骰
- b/p数字：优势/劣势转换数量
- u/d数字：增加/减少铜钱数量
- 次数：投掷次数（最多10次）
- 铜钱数量：3-100枚，支持表达式和技能名

例子：
.tq 5        # 投掷5枚铜钱
.tq b2 火   # 2个优势转换，铜钱数量为火技能值
.tq u2 3#p1 水+5  # 增加2枚铜钱，3次投掷，1个劣势转换，每次投掷水+5枚铜钱
.tq d1 b1 4   # 减少1枚铜钱，1个优势转换，投掷4枚铜钱
```

### .tqa - 三尺之下检定
```
.tqa(h)(b/p/u/d数字)(属性表达式)#(难度表达式)(@其他人)

检定规则：
- 难度 < 属性：1个阳爻成功（简单检定）
- 难度 = 属性：2个阳爻成功（标准检定）  
- 难度 > 属性，差值≤2：3个阳爻成功（困难检定）
- 难度 > 属性，差值>2：3个阳爻成功且自动增加劣势（极难检定）

成功类型：
- 难度≤3：普通成功
- 难度4-6：困难成功
- 难度≥7：极难成功

参数说明：
- h：暗骰检定
- b/p数字：优势/劣势转换数量
- u/d数字：增加/减少铜钱数量（基础3枚）
- @其他人：代替他人进行检定（需要管理员及以上权限）

例子：
.tqa 火#5      # 火检定，难度5
.tqa b1 金+3#6 # 优势检定，金+3对抗难度6
.tqa u1 水#5 @张三  # 增加1枚铜钱，暗骰代骰检定
.tqa d1 b2 木#8  # 减少1枚铜钱，2个优势转换，木属性检定
```

### .tqav - 三尺之下对抗
```
.tqav(b/p/u/d数字)(自己属性)#(b/p/u/d数字)(对方属性)@对方

对抗规则：
- 双方各投3枚铜钱，计算阳爻数量
- 阳爻数量+属性值=最终对抗值
- 数值高者获胜，相等为平手

参数说明：
- b/p数字：为对应属性添加优势/劣势
- u/d数字：增加/减少铜钱数量（基础3枚）
- 必须@对方进行对抗
- 支持属性表达式计算

例子：
.tqav 火#土 @张三     # 自己火对抗张三土
.tqav b1 水+2#p1 金+1 @李四  # 优势水+2对抗李四劣势金+1
.tqav u1 火#d1 土 @王五  # 自己增加1枚铜钱，对方减少1枚铜钱
```

### .摇卦 - 命数摇卦
```
.摇卦

摇卦功能：
- 投掷六枚铜钱生成六十四卦之一
- 自动计算五行属性（包括波动属性检定）
- 显示卦象信息、角色特质、寿数等
- 提供角色创建参考

波动检定：
- 阴爻：取低值（如"2-3"取2）
- 阳爻：取高值（如"2-3"取3）

寿数计算：
- 乾为天卦：固定寿数3
- 坤为地卦：固定寿数1
- 其他卦：五行属性之和9→寿数1，10→寿数2，11→寿数3

例子：
.摇卦    # 投掷六枚铜钱，生成命数卦象
```

---

## 使用示例

### 1. 基础铜钱占卜

**命令**​：
```
.tq 5
```

**回复**​：
```
[张三]进行占卜，掷出5枚铜钱，结果为: 阴、阳、阴、阳、阳
阴: 2次；阳: 3次
```

### 2. 优势劣势转换

**命令**​：
```
.tq b2p1 火
```

**回复**​：
```
[张三]进行占卜，掷出火(3)枚铜钱，结果为: 阳(阴)、阳、阴(阳)、阴(劣势)
阴: 2次；阳: 2次（优势2/劣势1转换）
```

### 3. 三尺之下检定

**命令**​：
```
.tqa 火#15
```

**回复**​：
```
[张三]进行三尺之下检定
属性：火(3) 难度：15
困难检定（需要3个阳爻）
铜钱：阳、阴、阳、阳
阳爻：3个（需要3个）→困难成功
```

### 4. 对抗检定

**命令**​：
```
.tqav 火#土 @李四
```

**回复**​：
```
对抗检定：
张三：火(3)
铜钱：阳、阳、阴 → 阳爻2个
总计：2+3=5

李四：土(2)
铜钱：阳、阴、阴 → 阳爻1个
总计：1+2=3

结果：张三获胜
```

### 5. 摇卦生成角色

**命令**​：
```
.摇卦
```

**回复**​：
```
[张三] 摇卦占卜完成：
第27卦 山雷颐
颐养天年，无饥无忧；顺势而为，修身养性。
━━━ 卦 象 结 果 ━━━
上卦：艮（☶）土
下卦：震（☳）木
━━━ 五 行 属 性 ━━━
金: 2；木: 3；水: 2；火: 2；土: 2
━━━ 波 动 检 定 ━━━
木为2-3，投掷结果为阳爻，取高值3
━━━ 角 色 信 息 ━━━
寿数：2
特殊能力：【养生】：你的恢复能力格外出众
角色特质：善于保养身体，懂得进退
姓名范例：颐真、养心
```

---

## 注意事项

##### 数据录入方法：

1、将骰子拉入群聊后，请先使用[.set temp sanchi]，让本群套用三尺之下模板（只需输入一次，其他人无需再输入）
2、玩家可使用[.摇卦]命令自动生成初始角色属性，或手动设置五行属性值。
3、玩家输入[.sn]或者[.sn template]，改变名片格式。
4、玩家输入[.sn auto on]，让名片数据能够自动变化。

---

## 常见问题

**Q：什么是优势/劣势转换？**
A：优势(b)将阴爻转为阳爻，劣势(p)将阳爻转为阴爻并增加额外铜钱。系统会智能处理转换顺序，确保不浪费优势。

**Q：摇卦生成的属性如何使用？**
A：摇卦会自动生成金、木、水、火、土五行属性，可直接用于tqa/tqav检定。波动属性会根据投掷结果自动确定最终值。

**Q：寿数是如何计算的？**
A：乾坤二卦有固定寿数，其他卦根据五行属性总和计算：9→1，10→2，11→3。

**Q：检定的成功等级有什么作用？**
A：根据难度数值显示不同成功类型：≤3为普通成功，4-6为困难成功，≥7为极难成功，帮助DM判断行动效果。

---

## 联系与反馈

如有问题或建议，请联系作者：Desom-fu

---

## 截图示例
![Image description](https://forum.olivos.run/assets/files/2025-09-20/1758353225-91152-image.png)
![Image description](https://forum.olivos.run/assets/files/2025-09-20/1758353419-774482-image.png)
![Image description](https://forum.olivos.run/assets/files/2025-09-20/1758353438-830279-image.png)
